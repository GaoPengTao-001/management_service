<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.org.management.mapper.OrganizationMapper">
    <select id="regionList" resultType="java.util.Map">
        SELECT
            distinct region_id "regionId", region_nm "regionNm"
        FROM
          T_REGION
    </select>

    <select id="fmcList" resultType="java.util.Map">
        SELECT
            distinct fmc_id "fmcId", fmc_nm "fmcNm"
        FROM
          T_REGION
        <where>
            <if test="'' != query.regionId and null != query.regionId">
                REGION_ID = #{query.regionId}
            </if>
        </where>
    </select>
    <select id="ascListByRegion" resultType="java.util.Map">
        SELECT
        distinct ASC_CD "ascCd", ASC_NM "ascNm"
        FROM
        T_REGION
        <where>
            <if test="'' != query.regionId and null != query.regionId">
                REGION_ID = #{query.regionId}
            </if>
            <if test="'' != query.fmcId and null != query.fmcId">
                and FMC_ID = #{query.fmcId}
            </if>
        </where>
    </select>
    <select id="provList" resultType="java.util.Map">
        SELECT
            distinct prov_id "provId", prov_com_nm "provComNm"
        FROM
          T_PROVINCE
    </select>
    <select id="cityList" resultType="java.util.Map">
        SELECT
            distinct CITY_ID "cityId", CITY_COM_NM "cityComNm"
        FROM
          T_PROVINCE
      <where>
          <if test="'' != query.provId and null != query.provId">
              prov_id = #{query.provId}
          </if>
      </where>
    </select>
    <select id="ascListByProvince" resultType="java.util.Map">
        SELECT
        distinct ASC_CD "ascCd", ASC_NM "ascNm"
        FROM
        T_PROVINCE
        <where>
            <if test="'' != query.provId and null != query.provId">
                prov_id = #{query.provId}
            </if>
            <if test="'' != query.cityId and null != query.cityId">
                and CITY_ID = #{query.cityId}
            </if>
        </where>
    </select>
    <select id="selectOutputValue" resultType="com.org.management.entity.OutputValue">
        SELECT
            id AS id,
            value_date AS valueDate,
            busid AS busid,
            totail AS totail,
            totail_last AS totailLast,
            totail_current AS totailCurrent,
            claim AS claim,
            claim_last AS claimLast,
            claim_current AS claimCurrent,
            guarantee AS guarantee,
            guarantee_last AS guaranteeLast,
            guarantee_current AS guaranteeCurrent,
            no_guarantee AS noGuarantee,
            no_guarantee_last AS noGuaranteeLast,
            no_guarantee_current AS noGuaranteeCurrent,
            no_claim AS noClaim,
            no_claim_last AS noClaimLast,
            no_claim_current AS noClaimCurrent,
            maintain AS maintain,
            maintain_last AS maintainLast,
            maintain_current AS maintainCurrent,
            REPAIR AS REPAIR,
            repair_last AS repairLast,
            repair_current AS repairCurrent,
            accident AS accident,
            accident_last AS accidentLast,
            accident_current AS accidentCurrent,
            sale AS sale,
            sale_last AS saleLast,
            sale_current AS saleCurrent,
            rework AS rework,
            rework_last AS reworkLast,
            rework_current AS reworkCurrent
        FROM
            T_OUTPUT_VALUE
        where busid = #{query.busId} and value_date = #{query.dateValue}
    </select>
    <select id="selectRegionId" resultType="com.org.management.entity.OrgInfo">
        SELECT DISTINCT
              REGION_ID id,
              REGION_NM name
            FROM
              T_REGION
            ORDER BY
              REGION_NM ASC
    </select>
    <select id="selectFmcIdByRegionId" resultType="com.org.management.entity.OrgInfo">
        SELECT DISTINCT
                    FMC_ID id,
                    FMC_NM name
                FROM
                    T_REGION
                WHERE
                    REGION_ID = #{id}
                ORDER BY
                    FMC_NM ASC
    </select>
    <select id="selectAscCdByFmcId" resultType="com.org.management.entity.OrgInfo">
        SELECT DISTINCT
              ASC_CD id,
              ASC_NM name
            FROM
              T_REGION
            where FMC_ID = #{id}
            ORDER BY
              ASC_NM ASC
    </select>
    <select id="selectOutputValueDetail" resultType="com.org.management.entity.OutputValue">
        SELECT
            id AS id,
            value_date AS valueDate,
            busid AS busid,
            totail AS totail,
            totail_last AS totailLast,
            totail_current AS totailCurrent,
            claim AS claim,
            claim_last AS claimLast,
            claim_current AS claimCurrent,
            guarantee AS guarantee,
            guarantee_last AS guaranteeLast,
            guarantee_current AS guaranteeCurrent,
            no_guarantee AS noGuarantee,
            no_guarantee_last AS noGuaranteeLast,
            no_guarantee_current AS noGuaranteeCurrent,
            no_claim AS noClaim,
            no_claim_last AS noClaimLast,
            no_claim_current AS noClaimCurrent,
            maintain AS maintain,
            maintain_last AS maintainLast,
            maintain_current AS maintainCurrent,
            REPAIR AS REPAIR,
            repair_last AS repairLast,
            repair_current AS repairCurrent,
            accident AS accident,
            accident_last AS accidentLast,
            accident_current AS accidentCurrent,
            sale AS sale,
            sale_last AS saleLast,
            sale_current AS saleCurrent,
            rework AS rework,
            rework_last AS reworkLast,
            rework_current AS reworkCurrent
        FROM
            T_OUTPUT_VALUE
        where busid in
        <foreach item="item" index="index" collection="ids"
                 open="(" separator="," close=")">
            #{item.id}
        </foreach>
       and value_date = #{dateValue}
    </select>
</mapper>